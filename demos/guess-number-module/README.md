# çŒœæ•°å­—æ¸¸æˆ - Calimero x NEAR é›†æˆæ¼”ç¤º

è¿™ä¸ªæ¼”ç¤ºé¡¹ç›®å±•ç¤ºäº†å¦‚ä½•å°†ç»å…¸çš„ Rust çŒœæ•°å­—æ¸¸æˆä¸ Calimero Network é›†æˆï¼Œå®ç°é“¾ä¸‹æ¸¸æˆé€»è¾‘å’Œé“¾ä¸Šç»“æœå­˜å‚¨çš„æ··åˆæ¶æ„ã€‚æ¸¸æˆè¿‡ç¨‹åœ¨æœ¬åœ°æ‰§è¡Œï¼Œè€Œæ¸¸æˆç»“æœé€šè¿‡ Calimero å­˜å‚¨åˆ° NEAR åŒºå—é“¾ä¸Šã€‚

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

### æ ¸å¿ƒç‰¹æ€§
- **é“¾ä¸‹æ¸¸æˆé€»è¾‘**: çŒœæ•°å­—æ¸¸æˆå®Œå…¨åœ¨æœ¬åœ°è¿è¡Œï¼Œç¡®ä¿å¿«é€Ÿå“åº”å’Œæµç•…ä½“éªŒ
- **é“¾ä¸Šç»“æœå­˜å‚¨**: æ¸¸æˆç»“æœé€šè¿‡ Calimero Network å®‰å…¨å­˜å‚¨åˆ° NEAR åŒºå—é“¾
- **æ•°æ®æ‰€æœ‰æƒ**: åˆ©ç”¨ Calimero çš„æ•°æ®æ‰€æœ‰æƒç‰¹æ€§ï¼Œç”¨æˆ·å®Œå…¨æ§åˆ¶è‡ªå·±çš„æ¸¸æˆæ•°æ®
- **éšç§ä¿æŠ¤**: æ¸¸æˆè¿‡ç¨‹ä¿æŒç§å¯†ï¼Œä»…ç»“æœä¸Šé“¾
- **å»ä¸­å¿ƒåŒ–èº«ä»½**: é›†æˆ DID (å»ä¸­å¿ƒåŒ–èº«ä»½) è¿›è¡Œç”¨æˆ·èº«ä»½ç®¡ç†

### æ¶æ„ä¼˜åŠ¿
- **æ··åˆè®¡ç®—æ¨¡å‹**: é“¾ä¸‹è®¡ç®— + é“¾ä¸Šå­˜å‚¨ï¼Œå…¼é¡¾æ€§èƒ½ä¸å¯ä¿¡åº¦
- **æˆæœ¬æ•ˆç›Š**: ä»…å…³é”®æ•°æ®ä¸Šé“¾ï¼Œå¤§å¹…é™ä½ Gas è´¹ç”¨
- **ç”¨æˆ·ä½“éªŒ**: æ¸¸æˆè¿‡ç¨‹æ— å»¶è¿Ÿï¼Œé“¾ä¸Šæ“ä½œå¼‚æ­¥å¤„ç†
- **å¯æ‰©å±•æ€§**: æ¡†æ¶å¯æ‰©å±•åˆ°æ›´å¤æ‚çš„æ¸¸æˆé€»è¾‘

## ğŸ® æ¸¸æˆè¯´æ˜

è¿™æ˜¯åŸºäºã€ŠRust ç¨‹åºè®¾è®¡è¯­è¨€ã€‹ç¬¬äºŒç« çš„ç»å…¸çŒœæ•°å­—æ¸¸æˆçš„å¢å¼ºç‰ˆæœ¬ï¼š

1. **æ¸¸æˆè§„åˆ™**: ç³»ç»Ÿéšæœºç”Ÿæˆä¸€ä¸ª 1-100 ä¹‹é—´çš„æ•°å­—ï¼Œç©å®¶è¿›è¡ŒçŒœæµ‹
2. **æ¸¸æˆåé¦ˆ**: ç³»ç»Ÿæç¤º"å¤ªå¤§äº†"ã€"å¤ªå°äº†"æˆ–"çŒœå¯¹äº†"
3. **æ¸¸æˆè®°å½•**: æ¯å±€æ¸¸æˆçš„ç»“æœï¼ˆå°è¯•æ¬¡æ•°ã€ç”¨æ—¶ã€æœ€ç»ˆç»“æœï¼‰éƒ½ä¼šå­˜å‚¨åˆ°åŒºå—é“¾
4. **å†å²æŸ¥è¯¢**: ç©å®¶å¯ä»¥æŸ¥è¯¢è‡ªå·±çš„å†å²æ¸¸æˆè®°å½•

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```mermaid
flowchart TD
    A[ç©å®¶] --> B[æœ¬åœ°æ¸¸æˆå®¢æˆ·ç«¯]
    B --> C[çŒœæ•°å­—æ¸¸æˆé€»è¾‘]
    C --> D[æ¸¸æˆç»“æœ]
    D --> E[Calimero Network]
    E --> F[NEAR åŒºå—é“¾]

    subgraph "é“¾ä¸‹å¤„ç†"
        C
        G[éšæœºæ•°ç”Ÿæˆ]
        H[ç”¨æˆ·è¾“å…¥å¤„ç†]
        I[æ¸¸æˆçŠ¶æ€ç®¡ç†]
    end

    subgraph "é“¾ä¸Šå­˜å‚¨"
        F
        J[æ¸¸æˆè®°å½•åˆçº¦]
        K[ç”¨æˆ·ç»Ÿè®¡]
        L[æ’è¡Œæ¦œæ•°æ®]
    end

    E --> J
    E --> K
    E --> L
```

### æ ¸å¿ƒç»„ä»¶

#### 1. æ¸¸æˆå¼•æ“ (Off-chain)
- **éšæœºæ•°ç”Ÿæˆå™¨**: ä½¿ç”¨ `rand` crate ç”Ÿæˆå®‰å…¨éšæœºæ•°
- **æ¸¸æˆé€»è¾‘å¤„ç†**: æœ¬åœ°å¤„ç†ç”¨æˆ·è¾“å…¥å’Œæ¸¸æˆçŠ¶æ€
- **æ€§èƒ½ä¼˜åŒ–**: æ— ç½‘ç»œå»¶è¿Ÿçš„å³æ—¶åé¦ˆ

#### 2. Calimero é›†æˆå±‚
- **æ•°æ®æ¡¥æ¥**: è¿æ¥æœ¬åœ°æ¸¸æˆå’ŒåŒºå—é“¾å­˜å‚¨
- **èº«ä»½ç®¡ç†**: DID é›†æˆï¼Œç¡®ä¿ç”¨æˆ·èº«ä»½ä¸€è‡´æ€§
- **æ•°æ®åŠ å¯†**: æ¸¸æˆæ•°æ®åŠ å¯†å­˜å‚¨å’Œä¼ è¾“

#### 3. NEAR æ™ºèƒ½åˆçº¦
- **æ¸¸æˆè®°å½•å­˜å‚¨**: å­˜å‚¨æ¸¸æˆç»“æœå’Œç»Ÿè®¡æ•°æ®
- **ç”¨æˆ·æ’è¡Œæ¦œ**: ç»´æŠ¤å…¨å±€å’Œä¸ªäººæ¸¸æˆç»Ÿè®¡
- **æ•°æ®æŸ¥è¯¢æ¥å£**: æä¾›å†å²è®°å½•æŸ¥è¯¢åŠŸèƒ½

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Rust 1.70+
- NEAR CLI å·¥å…·
- Calimero Network èŠ‚ç‚¹è®¿é—®æƒé™

### 1. ç¯å¢ƒè®¾ç½®

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/calimero-network/core.git
cd core/demos/guess-number-module

# å®‰è£…ä¾èµ–
cargo build

# é…ç½® NEAR è´¦æˆ· (å¦‚æœæ²¡æœ‰çš„è¯)
near login
```

### 2. éƒ¨ç½²æ™ºèƒ½åˆçº¦

```bash
# æ„å»ºåˆçº¦
cargo build --target wasm32-unknown-unknown --release

# éƒ¨ç½²åˆ° NEAR æµ‹è¯•ç½‘
near deploy --wasmFile target/wasm32-unknown-unknown/release/guess_number_contract.wasm --accountId your-account.testnet
```

### 3. é…ç½® Calimero èŠ‚ç‚¹

```bash
# å¯åŠ¨æœ¬åœ° Calimero èŠ‚ç‚¹
merod --config config/local-node.toml

# åˆ›å»ºæ¸¸æˆä¸Šä¸‹æ–‡
meroctl context create --name guess-number-game
```

### 4. è¿è¡Œæ¸¸æˆ

```bash
# å¯åŠ¨æ¸¸æˆå®¢æˆ·ç«¯
cargo run --bin guess-number-client

# æˆ–è€…ä½¿ç”¨ Web ç•Œé¢
cargo run --bin guess-number-server
# è®¿é—® http://localhost:8080
```

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### å‘½ä»¤è¡Œç‰ˆæœ¬

```bash
$ cargo run --bin guess-number-client

ğŸ® æ¬¢è¿æ¥åˆ°é“¾ä¸ŠçŒœæ•°å­—æ¸¸æˆï¼
ğŸ“Š è¿æ¥åˆ° Calimero Network...
âœ… å·²è¿æ¥åˆ° NEAR æµ‹è¯•ç½‘

ğŸ² å¼€å§‹æ–°æ¸¸æˆ (è¾“å…¥ 'quit' é€€å‡º)
ğŸ’­ çŒœä¸€ä¸ª 1 åˆ° 100 ä¹‹é—´çš„æ•°å­—: 50
ğŸ“ˆ å¤ªå¤§äº†ï¼å°è¯•ä¸€ä¸ªæ›´å°çš„æ•°å­—
ğŸ’­ çŒœä¸€ä¸ª 1 åˆ° 100 ä¹‹é—´çš„æ•°å­—: 25
ğŸ“‰ å¤ªå°äº†ï¼å°è¯•ä¸€ä¸ªæ›´å¤§çš„æ•°å­—
ğŸ’­ çŒœä¸€ä¸ª 1 åˆ° 100 ä¹‹é—´çš„æ•°å­—: 37
ğŸ‰ æ­å–œï¼ä½ çŒœå¯¹äº†ï¼

ğŸ“‹ æ¸¸æˆç»Ÿè®¡:
   ğŸ¯ ç›®æ ‡æ•°å­—: 37
   ğŸ”„ å°è¯•æ¬¡æ•°: 3
   â±ï¸  æ¸¸æˆæ—¶é•¿: 45 ç§’
   ğŸ’¾ æ­£åœ¨ä¿å­˜åˆ°åŒºå—é“¾...
   âœ… æ¸¸æˆè®°å½•å·²ä¿å­˜ï¼

ğŸ† ä½ çš„æ¸¸æˆå†å²:
   ğŸ“Š æ€»æ¸¸æˆæ•°: 15
   ğŸ¯ å¹³å‡å°è¯•æ¬¡æ•°: 4.2
   â­ æœ€ä½³è®°å½•: 2 æ¬¡çŒœä¸­
```

### Web ç•Œé¢ç‰ˆæœ¬

è®¿é—® `http://localhost:8080` ä½“éªŒå®Œæ•´çš„ Web æ¸¸æˆç•Œé¢ï¼ŒåŒ…æ‹¬ï¼š
- å®æ—¶æ¸¸æˆäº’åŠ¨
- å¯è§†åŒ–ç»Ÿè®¡å›¾è¡¨
- å†å²è®°å½•æŸ¥çœ‹
- å…¨çƒæ’è¡Œæ¦œ

## ğŸ“Š API æ¥å£

### æ¸¸æˆæ¥å£

```bash
# å¼€å§‹æ–°æ¸¸æˆ
POST /api/game/start
{
  "player_id": "user123",
  "difficulty": "normal"
}

# æäº¤çŒœæµ‹
POST /api/game/guess
{
  "game_id": "game_uuid",
  "guess": 42
}

# è·å–æ¸¸æˆçŠ¶æ€
GET /api/game/{game_id}/status

# ç»“æŸæ¸¸æˆå¹¶ä¿å­˜åˆ°é“¾ä¸Š
POST /api/game/{game_id}/finish
```

### ç»Ÿè®¡æ¥å£

```bash
# è·å–ç©å®¶ç»Ÿè®¡
GET /api/stats/player/{player_id}

# è·å–å…¨çƒæ’è¡Œæ¦œ
GET /api/stats/leaderboard

# è·å–æ¸¸æˆå†å²
GET /api/history/{player_id}
```

## ğŸ”§ é…ç½®è¯´æ˜

### Calimero é…ç½® (config/calimero.toml)

```toml
[network]
node_id = "guess-number-node"
context_id = "guess-number-context"

[near]
network = "testnet"
contract_account = "guess-number.testnet"

[storage]
provider = "near"
encryption = true

[game]
min_number = 1
max_number = 100
max_attempts = 10
timeout_seconds = 300
```

### NEAR åˆçº¦é…ç½®

```rust
// æ¸¸æˆè®°å½•ç»“æ„
#[derive(Serialize, Deserialize)]
pub struct GameRecord {
    pub player_id: String,
    pub target_number: u32,
    pub attempts: u32,
    pub duration_seconds: u64,
    pub timestamp: u64,
    pub success: bool,
}

// ç©å®¶ç»Ÿè®¡
#[derive(Serialize, Deserialize)]
pub struct PlayerStats {
    pub total_games: u32,
    pub total_wins: u32,
    pub average_attempts: f64,
    pub best_score: u32,
    pub total_time: u64,
}
```

## ğŸ” æ•°æ®éšç§ä¸å®‰å…¨

### éšç§ä¿æŠ¤æœºåˆ¶
1. **æ¸¸æˆè¿‡ç¨‹éšç§**: æ¸¸æˆè¿‡ç¨‹å®Œå…¨åœ¨æœ¬åœ°è¿›è¡Œï¼Œä¸ä¼šæ³„éœ²ä¸­é—´æ­¥éª¤
2. **é€‰æ‹©æ€§ä¸Šé“¾**: åªæœ‰æœ€ç»ˆç»“æœå’Œç»Ÿè®¡æ•°æ®ä¸Šé“¾å­˜å‚¨
3. **æ•°æ®åŠ å¯†**: æ•æ„Ÿæ•°æ®é€šè¿‡ Calimero åŠ å¯†å¤„ç†
4. **èº«ä»½ä¿æŠ¤**: æ”¯æŒåŒ¿åæ¸¸æˆæ¨¡å¼

### å®‰å…¨ç‰¹æ€§
- **é˜²ä½œå¼Šæœºåˆ¶**: é€šè¿‡å¯†ç å­¦è¯æ˜ç¡®ä¿æ¸¸æˆç»“æœçœŸå®æ€§
- **æ•°æ®å®Œæ•´æ€§**: åŒºå—é“¾ä¿è¯å†å²è®°å½•ä¸å¯ç¯¡æ”¹
- **è®¿é—®æ§åˆ¶**: åŸºäº DID çš„ç»†ç²’åº¦æƒé™ç®¡ç†

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### é“¾ä¸‹ä¼˜åŒ–
- **é›¶å»¶è¿Ÿæ¸¸æˆ**: æ‰€æœ‰æ¸¸æˆäº¤äº’éƒ½åœ¨æœ¬åœ°å®Œæˆ
- **æ‰¹é‡ä¸Šé“¾**: ç´¯ç§¯å¤šä¸ªæ¸¸æˆç»“æœåæ‰¹é‡æäº¤
- **ç¼“å­˜æœºåˆ¶**: æœ¬åœ°ç¼“å­˜å†å²æ•°æ®ï¼Œå‡å°‘é“¾ä¸ŠæŸ¥è¯¢

### é“¾ä¸Šä¼˜åŒ–
- **æ•°æ®å‹ç¼©**: ä¼˜åŒ–åˆçº¦å­˜å‚¨ç»“æ„
- **Gas ä¼˜åŒ–**: æœ€å°åŒ–é“¾ä¸Šè®¡ç®—å¤æ‚åº¦
- **æ‰¹å¤„ç†**: æ”¯æŒæ‰¹é‡æ“ä½œé™ä½æˆæœ¬
